@startuml Filter_Wardrobe_By_Category_Sequence
title ÐŸÐ¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð³Ð°Ñ€Ð´ÐµÑ€Ð¾Ð±Ð° Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼

actor "ðŸ‘¤ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ" as User
participant "ðŸ“± Ð˜Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ" as UI
participant "ðŸŽ® ÐšÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€" as Controller
participant "ðŸ› ï¸ Ð¡ÐµÑ€Ð²Ð¸Ñ Ð³Ð°Ñ€Ð´ÐµÑ€Ð¾Ð±Ð°" as WardrobeService
participant "ðŸ—„ï¸ Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…" as DB

User -> UI: ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÑ‚ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ "ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸"
activate User
activate UI

UI -> UI: ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹:\nðŸ‘• Ð’ÐµÑ€Ñ…\nðŸ‘– ÐÐ¸Ð·\nðŸ‘Ÿ ÐžÐ±ÑƒÐ²ÑŒ\nðŸ‘œ ÐÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹
deactivate UI

User -> UI: Ð’Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ "ðŸ‘• Ð’ÐµÑ€Ñ…"
activate UI
UI -> Controller: GET /api/wardrobe/items?category_id=1&user_id=123
activate Controller

Controller -> WardrobeService: getItemsByCategory(user_id, category_id)
activate WardrobeService

WardrobeService -> DB: SELECT * FROM ClothingItems\nWHERE user_id = ? AND category_id = ?\nORDER BY created_at DESC
activate DB

DB --> WardrobeService: items_list
deactivate DB

WardrobeService -> DB: SELECT name, type FROM Categories\nWHERE category_id = ?
activate DB
DB --> WardrobeService: category_info
deactivate DB

WardrobeService -> WardrobeService: enrichItemsWithCategoryInfo(items_list, category_info)
activate WardrobeService

WardrobeService -> WardrobeService: formatItemsForDisplay(items_list)
WardrobeService -> WardrobeService: generateThumbnailsIfNeeded(items_list)

alt ÐÐµÑ‚ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
    WardrobeService -> WardrobeService: prepareEmptyStateSuggestion(category_id)
    activate WardrobeService
    deactivate WardrobeService
end

WardrobeService -> Controller: ItemsListResponse({\n  items: items_list,\n  category: category_info,\n  count: items_list.length,\n  suggestions: suggestions\n})
deactivate WardrobeService

Controller -> UI: 200 OK\n{\n  "success": true,\n  "data": {\n    "items": [...],\n    "category": {\n      "name": "Ð’ÐµÑ€Ñ…",\n      "type": "Ð²ÐµÑ€Ñ…"\n    },\n    "count": 8,\n    "suggestions": [...]\n  }\n}
deactivate Controller

UI -> UI: ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº "ðŸ‘• Ð’ÐµÑ€Ñ… (8 Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²)"
UI -> UI: ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº
UI -> UI: ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð²ÐµÑ‰Ð¸

alt ÐŸÑƒÑÑ‚Ð°Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ
    UI -> UI: ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ:\n"Ð’ ÑÑ‚Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ð²ÐµÑ‰ÐµÐ¹.\nÐ”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ„ÑƒÑ‚Ð±Ð¾Ð»ÐºÑƒ?"
    UI -> User: ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð²ÐµÑ‰ÑŒ
else Ð•ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹
    UI -> UI: ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð°ÐºÑ†ÐµÐ½Ñ‚\nÐ½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
    UI -> User: ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²ÐµÑ‰Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ "Ð’ÐµÑ€Ñ…"
end

deactivate UI
deactivate User
@enduml
